<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="generator" content="Aspose.Words for .NET 10.5.0.0" /><title>数字媒体处理技术实验</title></head><body><div><h1 style="font-size:22pt; line-height:240.83%; margin:17pt 0pt 16.5pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:center; widows:0"><a name="_Toc10690"></a><span style="font-family:宋体; font-size:22pt; font-weight:bold">数字媒体处理技术实验</span></h1><h1 style="font-size:22pt; line-height:240.83%; margin:17pt 0pt 16.5pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:center; widows:0"><a name="_Toc4359"></a><span style="font-family:Calibri; font-size:22pt; font-weight:bold">——</span><span style="font-family:宋体; font-size:22pt; font-weight:bold">基于</span><span style="font-family:Calibri; font-size:22pt; font-weight:bold">MFC/OPENCV</span><span style="font-family:宋体; font-size:22pt; font-weight:bold">的可视化程序开发与图像处理算法</span></h1><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><a href="#_Toc10690"><span style="font-family:宋体; font-size:10.5pt">数字媒体处理技术实验</span><span style="font-family:Calibri; font-size:10.5pt">              </span><span style="font-family:Calibri; font-size:10.5pt">1</span></a></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><a href="#_Toc4359"><span style="font-family:Calibri; font-size:10.5pt">——</span><span style="font-family:宋体; font-size:10.5pt">基于</span><span style="font-family:Calibri; font-size:10.5pt">MFC/OPENCV</span><span style="font-family:宋体; font-size:10.5pt">的可视化程序开发与图像处理算法</span><span style="font-family:Calibri; font-size:10.5pt">              </span><span style="font-family:Calibri; font-size:10.5pt">1</span></a></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><a href="#_Toc27517"><span style="font-family:宋体; font-size:10.5pt">一</span><span style="font-family:宋体; font-size:10.5pt"> </span><span style="font-family:Calibri; font-size:10.5pt">opencv</span><span style="font-family:宋体; font-size:10.5pt">配置</span><span style="font-family:Calibri; font-size:10.5pt">              </span><span style="font-family:Calibri; font-size:10.5pt">1</span></a></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><a href="#_Toc11196"><span style="font-family:宋体; font-size:10.5pt">二</span><span style="font-family:宋体; font-size:10.5pt"> </span><span style="font-family:Calibri; font-size:10.5pt">MFC </span><span style="font-family:宋体; font-size:10.5pt">窗口程序设计</span><span style="font-family:Calibri; font-size:10.5pt">              </span><span style="font-family:Calibri; font-size:10.5pt">4</span></a></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><a href="#_Toc15055"><span style="font-family:Calibri; font-size:10.5pt">Windows</span><span style="font-family:宋体; font-size:10.5pt">应用程序结构</span><span style="font-family:Calibri; font-size:10.5pt">              </span><span style="font-family:Calibri; font-size:10.5pt">4</span></a></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><a href="#_Toc8724"><span style="font-family:宋体; font-size:10.5pt">消息与消息映射</span><span style="font-family:Calibri; font-size:10.5pt">              </span><span style="font-family:Calibri; font-size:10.5pt">6</span></a></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><a href="#_Toc25336"><span style="font-family:Calibri; font-size:10.5pt">MFC</span><span style="font-family:宋体; font-size:10.5pt">文档</span><span style="font-family:Calibri; font-size:10.5pt">/</span><span style="font-family:宋体; font-size:10.5pt">视图框架中各个对象的关系</span><span style="font-family:Calibri; font-size:10.5pt">              </span><span style="font-family:Calibri; font-size:10.5pt">9</span></a></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><a href="#_Toc24484"><span style="font-family:宋体; font-size:10.5pt">建立窗口程序示例</span><span style="font-family:Calibri; font-size:10.5pt">              </span><span style="font-family:Calibri; font-size:10.5pt">10</span></a></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><a href="#_Toc325"><span style="font-family:宋体; font-size:10.5pt">三</span><span style="font-family:宋体; font-size:10.5pt"> </span><span style="font-family:宋体; font-size:10.5pt">多线程图像处理程序设计</span><span style="font-family:Calibri; font-size:10.5pt">              </span><span style="font-family:Calibri; font-size:10.5pt">15</span></a></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:10.5pt">&#xa0;</span></p><h1 style="font-size:22pt; line-height:240.83%; margin:17pt 0pt 16.5pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; widows:0"><a name="_Toc27517"></a><span style="font-family:宋体; font-size:22pt; font-weight:bold">一</span><span style="font-family:宋体; font-size:22pt; font-weight:bold"> </span><span style="font-family:Calibri; font-size:22pt; font-weight:bold">opencv</span><span style="font-family:宋体; font-size:22pt; font-weight:bold">配置</span></h1><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">OpenCV</span><span style="font-family:宋体; font-size:12pt">是一个开源的计算机视觉库，其全称为：</span><span style="font-family:Calibri; font-size:12pt">Open Source Computer Vision Library</span><span style="font-family:宋体; font-size:12pt">。它于</span><span style="font-family:Calibri; font-size:12pt">1999</span><span style="font-family:宋体; font-size:12pt">年由</span><span style="font-family:Calibri; font-size:12pt">Intel</span><span style="font-family:宋体; font-size:12pt">建立，现在由</span><span style="font-family:Calibri; font-size:12pt">Willow Garage</span><span style="font-family:宋体; font-size:12pt">提供支持。其是一个基于</span><span style="font-family:Calibri; font-size:12pt">BSD</span><span style="font-family:宋体; font-size:12pt">许可证授权（开源）发行的跨平台计算机视觉库，可以运行在</span><span style="font-family:Calibri; font-size:12pt">Linux</span><span style="font-family:宋体; font-size:12pt">、</span><span style="font-family:Calibri; font-size:12pt">Windows</span><span style="font-family:宋体; font-size:12pt">和</span><span style="font-family:Calibri; font-size:12pt">Mac OS</span><span style="font-family:宋体; font-size:12pt">操作系统上。</span><span style="font-family:Calibri; font-size:12pt">OpenCV</span><span style="font-family:宋体; font-size:12pt">的一个目标是构建一个简单易用的计算机视觉框架，以帮助开发人员更快速便捷地设计更复杂的计算机视觉相关的应用程序。其包含</span><span style="font-family:Calibri; font-size:12pt">500</span><span style="font-family:宋体; font-size:12pt">多个函数，覆盖了计算机视觉的许多应用领域，比如用户界面、信息安全、立体视觉、产品检测、机器学习等。</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">OpenCV</span><span style="font-family:宋体; font-size:12pt">主体分为五个模块，其中的四个模块如图所示。</span><span style="font-family:Calibri; font-size:12pt">OpenCV</span><span style="font-family:宋体; font-size:12pt">的</span><span style="font-family:Calibri; font-size:12pt">CV</span><span style="font-family:宋体; font-size:12pt">模块包含基本的图像处理函数和高级的计算机视觉算法。</span><span style="font-family:Calibri; font-size:12pt">ML</span><span style="font-family:宋体; font-size:12pt">为机器学习库，一些基于统计的分类和聚类工具包含于其中。</span><span style="font-family:Calibri; font-size:12pt">HighGUI</span><span style="font-family:宋体; font-size:12pt">包含图像和视频输入</span><span style="font-family:Calibri; font-size:12pt">/</span><span style="font-family:宋体; font-size:12pt">输出的函数。</span><span style="font-family:Calibri; font-size:12pt">CXCore</span><span style="font-family:宋体; font-size:12pt">包含一些基本的数据结构和相关的函数。图</span><span style="font-family:Calibri; font-size:12pt">3-3</span><span style="font-family:宋体; font-size:12pt">中并没有包含</span><span style="font-family:Calibri; font-size:12pt">CvAux</span><span style="font-family:宋体; font-size:12pt">模块，该模块中一般存放一些即将淘汰的算法和函数，同时还有一些新出现的实验性的算法和函数。</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt"> </span><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.001.jpeg" width="431" height="258" alt="" /></p><p style="margin:0pt; orphans:0; text-align:center; text-indent:21pt; widows:0"><span style="font-family:Calibri; font-size:12pt">OpenCV</span><span style="font-family:宋体; font-size:12pt">的基本结构</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:12pt">OpenCV</span><span style="font-family:宋体; font-size:12pt">也提供了对</span><span style="font-family:Calibri; font-size:12pt">MFC</span><span style="font-family:宋体; font-size:12pt">的支持，</span><span style="font-family:Calibri; font-size:12pt">CvvImage</span><span style="font-family:宋体; font-size:12pt">类里面提供了</span><span style="font-family:Calibri; font-size:12pt">Show()</span><span style="font-family:宋体; font-size:12pt">和</span><span style="font-family:Calibri; font-size:12pt">DrawToHDC</span><span style="font-family:Calibri; font-size:12pt">()</span><span style="font-family:宋体; font-size:12pt">两个方法将图像显示到对指定的区域。</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:12pt">&#xa0;</span></p><p style="margin:0pt 0pt 0pt 18pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:Calibri; font-size:12pt">1.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt">安装</span><span style="font-family:Calibri; font-size:12pt">c:¥opencv</span></p><p style="margin:0pt 0pt 0pt 18pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:12pt">&#xa0;</span></p><p style="margin:0pt 0pt 0pt 18pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:Calibri; font-size:12pt">2.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt">这让系统在运行</span><span style="font-family:Calibri; font-size:12pt">opencv</span><span style="font-family:宋体; font-size:12pt">程序的时候知道去哪里找</span><span style="font-family:Calibri; font-size:12pt">dll</span><span style="font-family:宋体; font-size:12pt">文件，以下皆可：</span></p><p style="margin:0pt 0pt 0pt 36pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="background-color:#ffffff; color:#000000; font-family:Calibri; font-size:12pt">a)</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="background-color:#ffffff; color:#000000; font-family:宋体; font-size:12pt">添加环境变量</span><span style="background-color:#ffffff; color:#000000; font-family:Helvetica; font-size:12pt">OPENCV</span><span style="background-color:#ffffff; color:#000000; font-family:宋体; font-size:12pt">：</span><span style="background-color:#ffffff; color:#000000; font-family:Helvetica; font-size:12pt">c:\openc</span></p><p style="margin:0pt 0pt 0pt 36pt; orphans:0; text-align:justify; widows:0"><span style="background-color:#ffffff; color:#000000; font-family:宋体; font-size:12pt">添加</span><span style="background-color:#ffffff; color:#000000; font-family:Helvetica; font-size:12pt">path</span><span style="background-color:#ffffff; color:#000000; font-family:宋体; font-size:12pt">：</span><span style="font-family:Calibri; font-size:12pt">c:¥opencv¥</span><span style="background-color:#ffffff; color:#000000; font-family:Helvetica; font-size:12pt">build\x86\vc10\bin</span><span style="background-color:#ffffff; color:#000000; font-family:宋体; font-size:12pt">。</span></p><p style="margin:0pt 0pt 0pt 36pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="background-color:#ffffff; color:#000000; font-family:Calibri; font-size:12pt">b)</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="background-color:#ffffff; color:#000000; font-family:宋体; font-size:12pt">将对应</span><span style="background-color:#ffffff; color:#000000; font-family:Helvetica; font-size:12pt">dll</span><span style="background-color:#ffffff; color:#000000; font-family:宋体; font-size:12pt">拷贝到</span><span style="background-color:#ffffff; color:#000000; font-family:Helvetica; font-size:12pt">c:¥windows¥system32</span><span style="background-color:#ffffff; color:#000000; font-family:宋体; font-size:12pt">目录下。</span></p><p style="margin:0pt 0pt 0pt 36pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="background-color:#ffffff; color:#000000; font-family:Calibri; font-size:12pt">c)</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="background-color:#ffffff; color:#000000; font-family:宋体; font-size:12pt">将</span><span style="background-color:#ffffff; color:#000000; font-family:Helvetica; font-size:12pt">dll</span><span style="background-color:#ffffff; color:#000000; font-family:宋体; font-size:12pt">拷贝到</span><span style="background-color:#ffffff; color:#000000; font-family:Helvetica; font-size:12pt">debug</span><span style="background-color:#ffffff; color:#000000; font-family:宋体; font-size:12pt">或</span><span style="background-color:#ffffff; color:#000000; font-family:Helvetica; font-size:12pt">release</span><span style="background-color:#ffffff; color:#000000; font-family:宋体; font-size:12pt">等</span><span style="background-color:#ffffff; color:#000000; font-family:Helvetica; font-size:12pt">exe</span><span style="background-color:#ffffff; color:#000000; font-family:宋体; font-size:12pt">输出目录下。</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:12pt">&#xa0;</span></p><p style="margin:0pt 0pt 0pt 18pt; orphans:0; text-align:justify; text-indent:-18pt; widows:0"><span style="font-family:Calibri; font-size:12pt">3.</span><span style="font:7.0pt 'Times New Roman'">&#xa0;&#xa0;&#xa0;&#xa0;&#xa0; </span><span style="font-family:宋体; font-size:12pt">配置</span><span style="font-family:Calibri; font-size:12pt">VC</span><span style="font-family:宋体; font-size:12pt">环境</span></p><p style="margin:0pt 0pt 0pt 18pt; orphans:0; text-align:justify; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.002.png" width="331" height="407" alt="" /></p><p style="margin:0pt 0pt 0pt 18pt; orphans:0; text-align:justify; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.003.png" width="554" height="108" alt="" /></p><p style="margin:0pt 0pt 0pt 18pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:12pt">&#xa0;</span></p><p style="background-color:#ffffff; line-height:18.9pt; margin:0pt"><span style="color:#000000; font-family:宋体; font-size:12pt">修改</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">vc</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">++ directories </span><span style="color:#000000; font-family:宋体; font-size:12pt">下面的</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">include directories </span><span style="color:#000000; font-family:Helvetica; font-size:12pt">&#xa0;</span><span style="color:#000000; font-family:宋体; font-size:12pt">和</span><span style="color:#000000; font-family:宋体; font-size:12pt"> </span><span style="color:#000000; font-family:Helvetica; font-size:12pt">library directories </span><span style="color:#000000; font-family:宋体; font-size:12pt">值。</span></p><p style="background-color:#ffffff; line-height:18.9pt; margin:0pt"><span style="color:#000000; font-family:Helvetica; font-size:12pt">&#xa0;</span><span style="color:#000000; font-family:宋体; font-size:12pt"> </span><span style="color:#000000; font-family:Helvetica; font-size:12pt">&#xa0;</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">include directories</span><span style="color:#000000; font-family:宋体; font-size:12pt">的值在原值后面加上</span></p><p style="background-color:#ffffff; line-height:18.9pt; margin:0pt"><span style="color:#000000; font-family:Helvetica; font-size:12pt">&#xa0;</span><span style="color:#000000; font-family:宋体; font-size:12pt"> </span><span style="color:#000000; font-family:Helvetica; font-size:12pt">&#xa0;</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">;$</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">(OPENCV)\build\include</span></p><p style="background-color:#ffffff; line-height:18.9pt; margin:0pt"><span style="color:#000000; font-family:Helvetica; font-size:12pt">&#xa0;</span><span style="color:#000000; font-family:Helvetica; font-size:12pt"> </span><span style="color:#000000; font-family:Helvetica; font-size:12pt">&#xa0;</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">;$</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">(OPENCV)\build\include\</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">opencv</span></p><p style="background-color:#ffffff; line-height:18.9pt; margin:0pt"><span style="color:#000000; font-family:Helvetica; font-size:12pt">&#xa0;</span><span style="color:#000000; font-family:Helvetica; font-size:12pt"> </span><span style="color:#000000; font-family:Helvetica; font-size:12pt">&#xa0;</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">;$</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">(OPENCV)\build\include\opencv2</span></p><p style="background-color:#ffffff; line-height:18.9pt; margin:0pt"><span style="color:#000000; font-family:Helvetica; font-size:12pt">&#xa0;</span><span style="color:#000000; font-family:Helvetica; font-size:12pt"> </span><span style="color:#000000; font-family:Helvetica; font-size:12pt">&#xa0;</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">library directories</span><span style="color:#000000; font-family:宋体; font-size:12pt">的值在原值后面加上</span></p><p style="background-color:#ffffff; line-height:18.9pt; margin:0pt"><span style="color:#000000; font-family:Helvetica; font-size:12pt">&#xa0;</span><span style="color:#000000; font-family:宋体; font-size:12pt"> </span><span style="color:#000000; font-family:Helvetica; font-size:12pt">&#xa0;</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">;$</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">(OPENCV)\build\x86\vc10\lib</span></p><p style="background-color:#ffffff; line-height:18.9pt; margin:0pt"><span style="color:#000000; font-family:Helvetica; font-size:12pt">&#xa0;</span></p><p style="background-color:#ffffff; line-height:18.9pt; margin:0pt"><span style="color:#000000; font-family:宋体; font-size:12pt">注意：</span></p><p style="background-color:#ffffff; line-height:18.9pt; margin:0pt"><span style="color:#000000; font-family:Helvetica; font-size:12pt">1</span><span style="color:#000000; font-family:宋体; font-size:12pt">这里不要同时加上</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">;$(OPENCV)\build\x86\vc10\</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">staticlib</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">;</span><span style="color:#000000; font-family:宋体; font-size:12pt">不然会报错的。</span></p><p style="background-color:#ffffff; line-height:18.9pt; margin:0pt"><span style="color:#000000; font-family:Helvetica; font-size:12pt">2 </span><span style="color:#000000; font-family:宋体; font-size:12pt">不成功的话可能会报</span><span style="color:#000000; font-family:宋体; font-size:12pt"> </span><span style="color:#000000; font-family:宋体; font-size:12pt">缺少</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">tbb_debug.dll,</span><span style="color:#000000; font-family:宋体; font-size:12pt">从</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">%OPENCV%¥build¥common¥</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">tbb</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">¥ia32¥vc10</span><span style="color:#000000; font-family:宋体; font-size:12pt">目录拷贝</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">tbb_debug.dll</span><span style="color:#000000; font-family:宋体; font-size:12pt">到目录</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">%OPENCV%¥build¥x86¥vc10¥bin</span><span style="color:#000000; font-family:宋体; font-size:12pt">下。</span></p><p style="background-color:#ffffff; line-height:18.9pt; margin:0pt"><span style="color:#000000; font-family:Helvetica; font-size:12pt">&#xa0;</span></p><p style="background-color:#ffffff; line-height:18.9pt; margin:0pt"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.004.png" width="554" height="162" alt="" /></p><p style="background-color:#ffffff; line-height:18.9pt; margin:0pt"><span style="color:#000000; font-family:宋体; font-size:12pt">在</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">linker</span><span style="color:#000000; font-family:宋体; font-size:12pt">下面加入</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">lib</span><span style="color:#000000; font-family:宋体; font-size:12pt">依赖项，通常只需要</span><span style="color:#000000; font-family:Helvetica; font-size:12pt">cv.lib cvaux.lib cxcore.lib highgui.lib</span><span style="color:#000000; font-family:宋体; font-size:12pt">几个即可</span></p><p style="margin:0pt 0pt 0pt 18pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:12pt">              </span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:宋体; font-size:12pt; font-weight:bold">实验任务</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt; font-weight:bold">1</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt; font-weight:bold"> </span><span style="color:#ff0000; font-family:宋体; font-size:12pt; font-weight:bold">编程</span><span style="color:#ff0000; font-family:宋体; font-size:12pt; font-weight:bold">环境与基础</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">：</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:宋体; font-size:12pt">查看实验室机器的</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">opencv</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">配置环境；在自己机器上配置、安装</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">opencv</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:宋体; font-size:12pt">了解</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">VC</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">项目</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">管理配置方式</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:宋体; font-size:12pt">自己</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">进一步学习</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">基于</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">cmake</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">的项目配置与编译方式</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:12pt">&#xa0;</span></p><h1 style="font-size:22pt; line-height:240.83%; margin:17pt 0pt 16.5pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; widows:0"><a name="_Toc11196"></a><span style="font-family:宋体; font-size:22pt; font-weight:bold">二</span><span style="font-family:宋体; font-size:22pt; font-weight:bold"> </span><span style="font-family:Calibri; font-size:22pt; font-weight:bold">MFC </span><span style="font-family:宋体; font-size:22pt; font-weight:bold">窗口程序设计</span></h1><h2 style="font-size:16pt; line-height:173.33%; margin:13pt 0pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; widows:0"><a name="_Toc326858185"></a><a name="_Toc15055"></a><span style="font-family:Cambria; font-size:16pt; font-weight:bold">Windows</span><span style="font-family:宋体; font-size:16pt; font-weight:bold">应用程序结构</span></h2><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">Windows</span><span style="font-family:宋体; font-size:12pt">操作系统中，显示给用户的界面是窗体，并使用句柄标识不同的窗体，所谓句柄就是一些复杂对象的标识，比如窗口、按钮、滚动条、光标、图形设备上下文等。然后通过事件和消息窗体命令，并且使用消息队列按照消息发送的先后顺序处理。</span></p><p style="margin:0pt; orphans:0; text-align:center; text-indent:24pt; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.005.jpeg" width="425" height="446" alt="" /></p><p style="line-height:20pt; margin:0pt; orphans:0; text-align:center; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">图</span><span style="font-family:'Times New Roman'; font-size:12pt">2-1 Windows</span><span style="font-family:宋体; font-size:12pt">系统、应用程序与窗口函数之间的关系</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">入口函数是所有的</span><span style="font-family:Calibri; font-size:12pt">Windows</span><span style="font-family:宋体; font-size:12pt">程序都必须拥有的，它作为一个程序开始执行的切入点。在默认的情况下，以</span><span style="font-family:Calibri; font-size:12pt">WinMain</span><span style="font-family:Calibri; font-size:12pt">()</span><span style="font-family:宋体; font-size:12pt">作为应用程序的入口。在</span><span style="font-family:Calibri; font-size:12pt">Win32</span><span style="font-family:宋体; font-size:12pt">平台下，它的函数声明如下：</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">int</span><span style="font-family:Calibri; font-size:12pt"> APIENTRY </span><span style="font-family:Calibri; font-size:12pt">WinMain</span><span style="font-family:Calibri; font-size:12pt">(</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">HINSTANCE </span><span style="font-family:Calibri; font-size:12pt">hInstance</span><span style="font-family:Calibri; font-size:12pt">,      //</span><span style="font-family:宋体; font-size:12pt">当前实例句柄</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">HINSTANCE </span><span style="font-family:Calibri; font-size:12pt">hPrevInstance</span><span style="font-family:Calibri; font-size:12pt">,  //</span><span style="font-family:宋体; font-size:12pt">前一个实例句柄</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">LPSTR     </span><span style="font-family:Calibri; font-size:12pt">lpCmdLine</span><span style="font-family:Calibri; font-size:12pt">,      //</span><span style="font-family:宋体; font-size:12pt">序命令行的指针</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">int</span><span style="font-family:Calibri; font-size:12pt">       </span><span style="font-family:Calibri; font-size:12pt">nCmdShow</span><span style="font-family:Calibri; font-size:12pt">        //</span><span style="font-family:宋体; font-size:12pt">窗口的显示方式标志</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">)</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在我们创建窗口之前，需要调用窗口的注册函数</span><span style="font-family:Calibri; font-size:12pt">RegisterClass</span><span style="font-family:Calibri; font-size:12pt">(WINDCLASS &amp;</span><span style="font-family:Calibri; font-size:12pt">wc</span><span style="font-family:Calibri; font-size:12pt">)</span><span style="font-family:宋体; font-size:12pt">把定义好的窗口样式注册到系统中。一旦使用</span><span style="font-family:Calibri; font-size:12pt">RegisterClass</span><span style="font-family:Calibri; font-size:12pt">(WINDCLASS &amp;</span><span style="font-family:Calibri; font-size:12pt">wc</span><span style="font-family:Calibri; font-size:12pt">)</span><span style="font-family:宋体; font-size:12pt">注册成功，系统中就会存在本次定义的窗口类型，就可以使用这个窗口类型作为一个模板来创建一个或者多个窗口。</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">然后使用</span><span style="font-family:Calibri; font-size:12pt">CreateWindow</span><span style="font-family:Calibri; font-size:12pt">()</span><span style="font-family:宋体; font-size:12pt">函数创建窗口。窗口创建成功之后，会返回窗口的句柄。以后就可以用这个句柄类对窗口进行操作。</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">接着就可以调用</span><span style="font-family:Calibri; font-size:12pt">ShowWindow</span><span style="font-family:Calibri; font-size:12pt">()</span><span style="font-family:宋体; font-size:12pt">和</span><span style="font-family:Calibri; font-size:12pt">UpdateWindow</span><span style="font-family:Calibri; font-size:12pt">()</span><span style="font-family:宋体; font-size:12pt">将窗口显示在计算机显示器的屏幕上。窗口完成创建和成功显示后，应用程序的初始化工作也就基本的结束，然后就是重要的消息循环部分。</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">while</span><span style="font-family:Calibri; font-size:12pt">(</span><span style="font-family:Calibri; font-size:12pt">GetMessage</span><span style="font-family:Calibri; font-size:12pt">(&amp;</span><span style="font-family:Calibri; font-size:12pt">msg,NULL,NULL,NULL</span><span style="font-family:Calibri; font-size:12pt">))</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">{</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">    </span><span style="font-family:Calibri; font-size:12pt">TranslateMessage</span><span style="font-family:Calibri; font-size:12pt">(</span><span style="font-family:Calibri; font-size:12pt">&amp;</span><span style="font-family:Calibri; font-size:12pt">msg</span><span style="font-family:Calibri; font-size:12pt">);</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">    </span><span style="font-family:Calibri; font-size:12pt">DispatchMessage</span><span style="font-family:Calibri; font-size:12pt">(</span><span style="font-family:Calibri; font-size:12pt">&amp;</span><span style="font-family:Calibri; font-size:12pt">msg</span><span style="font-family:Calibri; font-size:12pt">);</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">}</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">这里</span><span style="font-family:Calibri; font-size:12pt">GetMessage</span><span style="font-family:Calibri; font-size:12pt">()</span><span style="font-family:宋体; font-size:12pt">是将消息从消息队列中取出来，放到</span><span style="font-family:Calibri; font-size:12pt">msg</span><span style="font-family:宋体; font-size:12pt">变量里面，用户给出的键盘消息是通过</span><span style="font-family:Calibri; font-size:12pt">TranslateMessage</span><span style="font-family:Calibri; font-size:12pt">()</span><span style="font-family:宋体; font-size:12pt">将其转换为字符消息，然后使用</span><span style="font-family:Calibri; font-size:12pt">DispatchMessage</span><span style="font-family:Calibri; font-size:12pt">()</span><span style="font-family:宋体; font-size:12pt">函数向系统派送消息。</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在</span><span style="font-family:Calibri; font-size:12pt">Windows</span><span style="font-family:宋体; font-size:12pt">的窗口应用程序里面，是通过</span><span style="font-family:Calibri; font-size:12pt">“</span><span style="font-family:宋体; font-size:12pt">窗口函数</span><span style="font-family:Calibri; font-size:12pt">”</span><span style="font-family:宋体; font-size:12pt">来处理各种的消息。在这里开发者需要编写大量的码去处理各种任务。该函数的定义如下：</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">LRESULT CALLBACK </span><span style="font-family:Calibri; font-size:12pt">WndProc</span><span style="font-family:Calibri; font-size:12pt">(</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">HWND </span><span style="font-family:Calibri; font-size:12pt">hwnd</span><span style="font-family:Calibri; font-size:12pt">,         //</span><span style="font-family:宋体; font-size:12pt">派送消息的窗口句柄</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">UINT message,      //</span><span style="font-family:宋体; font-size:12pt">系统传递来的消息标识</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">WPARAM </span><span style="font-family:Calibri; font-size:12pt">wParam</span><span style="font-family:Calibri; font-size:12pt">,     //</span><span style="font-family:宋体; font-size:12pt">消息的附加参数</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">LPARAM </span><span style="font-family:Calibri; font-size:12pt">lParam</span><span style="font-family:Calibri; font-size:12pt">)     //</span><span style="font-family:宋体; font-size:12pt">消息的附件参数</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">图</span><span style="font-family:Calibri; font-size:12pt">2-1</span><span style="font-family:宋体; font-size:12pt">给出了</span><span style="font-family:Calibri; font-size:12pt">Windows</span><span style="font-family:宋体; font-size:12pt">系统，应用程序，窗口函数之间的关系。一个</span><span style="font-family:Calibri; font-size:12pt">Windows</span><span style="font-family:宋体; font-size:12pt">程序员如果想要顺利的开发出一款优秀的</span><span style="font-family:Calibri; font-size:12pt">Windows</span><span style="font-family:宋体; font-size:12pt">应用程序，就非常有必要去深入地理解</span><span style="font-family:Calibri; font-size:12pt">Windows</span><span style="font-family:宋体; font-size:12pt">系统、主函数、窗口函数之间的相互关系。这里</span><span style="font-family:Calibri; font-size:12pt">Windows</span><span style="font-family:宋体; font-size:12pt">系统负责主函数和窗口函数的调用，应用程序启动以后系统会首先调用主函数。当系统得到了由主函数获取的窗口函数消息后，会根据产生事件的窗口类型提供的函数指针去调用对应的窗口函数，完成事件的响应和消息处理。</span></p><h2 style="font-size:16pt; line-height:173.33%; margin:13pt 0pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; widows:0"><a name="_Toc326858186"></a><a name="_Toc8724"></a><span style="font-family:宋体; font-size:16pt; font-weight:bold">消息与消息映射</span></h2><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">由于</span><span style="font-family:Calibri; font-size:12pt">Windows</span><span style="font-family:宋体; font-size:12pt">应用程序是基于事件驱动的，并且是由系统去接收输入再转给应用程序。应用程序如果想要去调用某个函数获取用户的输入，就需要等待系统去接收输入然后传递给应用程序，应用程序才能去调用对应的函数。前一节讲过，每一个窗口都有其对应的窗口函数。应用程序运行过程中，当有对应的窗口输入时，系统就会调用与之对应的窗口函数，处理输入和执行对系统的控制。</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在</span><span style="font-family:Calibri; font-size:12pt">Windows</span><span style="font-family:宋体; font-size:12pt">应用程序中，输入是通过消息的形式传递给窗口函数的。当系统接受到一个输入事件，就会在系统中产生一条对应的消息。消息可以通过系统或者应用程序去创建，由此可将消息分为系统消息和应用程序消息。也可以根据消息的发送途径，将消息划分为队列消息和非队列消息。队列消息是指发送消息到先进先出的系统消息队列中，然后到线程消息队列。队列消息用于存储用户通过鼠标或键盘给出的输入，也可以存储重绘消息和退出消息等。在程序中要想将消息发送到消息队列中，就要调用</span><span style="font-family:Calibri; font-size:12pt">PostMessage</span><span style="font-family:Calibri; font-size:12pt">()</span><span style="font-family:宋体; font-size:12pt">函数去完成。非队列消息是使用系统定义内存对象临时存储消息，这种消息是直接的发送给目的窗口的窗口函数。除了第一种队列消息外，其他消息一般都采用这种处理方式。非队列消息是使用</span><span style="font-family:Calibri; font-size:12pt">SendMessage</span><span style="font-family:Calibri; font-size:12pt">()</span><span style="font-family:宋体; font-size:12pt">函数将消息直接发送给对应窗口的窗口函数。图</span><span style="font-family:Calibri; font-size:12pt">2-2</span><span style="font-family:宋体; font-size:12pt">展示了事件和消息的传递过程。下面为消息的定义结构：</span></p><p style="margin:0pt; orphans:0; text-align:center; text-indent:24pt; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.006.jpeg" width="495" height="462" alt="" /></p><p style="line-height:20pt; margin:0pt; orphans:0; text-align:center; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">图</span><span style="font-family:'Times New Roman'; font-size:12pt">2-2</span><span style="font-family:宋体; font-size:12pt">事件及消息的传递过程</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">&#xa0;</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:11pt">Typedef</span><span style="font-family:Calibri; font-size:11pt"> </span><span style="font-family:Calibri; font-size:11pt">struct</span><span style="font-family:Calibri; font-size:11pt"> </span><span style="font-family:Calibri; font-size:11pt">tagMSG</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:11pt">{</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:11pt">        HWND    </span><span style="font-family:Calibri; font-size:11pt">hwnd</span><span style="font-family:Calibri; font-size:11pt">;                 //</span><span style="font-family:宋体; font-size:11pt">产生消息的窗口句柄</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:11pt">        </span><span style="font-family:Calibri; font-size:11pt">UINT       message;            //</span><span style="font-family:宋体; font-size:11pt">消息标识码</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:11pt">        </span><span style="font-family:Calibri; font-size:11pt">WPARAM    </span><span style="font-family:Calibri; font-size:11pt">wParam</span><span style="font-family:Calibri; font-size:11pt">;      //</span><span style="font-family:宋体; font-size:11pt">消息附加信息</span><span style="font-family:Calibri; font-size:11pt">1</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:11pt">        LPARAM     </span><span style="font-family:Calibri; font-size:11pt">lParam</span><span style="font-family:Calibri; font-size:11pt">;        //</span><span style="font-family:宋体; font-size:11pt">消息</span><span style="font-family:Calibri; font-size:11pt">/</span><span style="font-family:宋体; font-size:11pt">附加信息</span><span style="font-family:Calibri; font-size:11pt">2</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:11pt">        DWORD       time;            //</span><span style="font-family:宋体; font-size:11pt">消息进入消息队列的时刻</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:11pt">        </span><span style="font-family:Calibri; font-size:11pt">POINT          </span><span style="font-family:Calibri; font-size:11pt">pt</span><span style="font-family:Calibri; font-size:11pt">;                //</span><span style="font-family:宋体; font-size:11pt">表示发送该消息是光标的位置</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:11pt">}</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在传统的</span><span style="font-family:Calibri; font-size:12pt">Windows</span><span style="font-family:宋体; font-size:12pt">应用程序中，窗口函数里面是使用</span><span style="font-family:Calibri; font-size:12pt">switch-case</span><span style="font-family:宋体; font-size:12pt">结构来处理发送给窗口的消息。后来</span><span style="font-family:Calibri; font-size:12pt">MFC</span><span style="font-family:宋体; font-size:12pt">运用了消息映射机制来进行消息的处理。首先，在一个需要进行消息处理的类里面，为每一个消息声明一个消息处理函数，其格式为：</span><span style="font-family:Calibri; font-size:12pt">afx_msg</span><span style="font-family:Calibri; font-size:12pt"> void </span><span style="font-family:宋体; font-size:12pt">消息处理函数的名称（）。在每一需要进行消息处理的类里面都会有一张消息映射表，它的表项结构为</span><span style="font-family:Calibri; font-size:12pt">AFX_MSGMAP_ENTRY</span><span style="font-family:宋体; font-size:12pt">，其结构如下所示：</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">Struct</span><span style="font-family:Calibri; font-size:12pt"> AFX_MSGMAP_ENTRY</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">{</span><span style="font-family:Calibri; font-size:12pt">    UINT </span><span style="font-family:Calibri; font-size:12pt">nMessage</span><span style="font-family:Calibri; font-size:12pt">;       // Windows</span><span style="font-family:宋体; font-size:12pt">消息标识</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">    </span><span style="font-family:Calibri; font-size:12pt">UINT </span><span style="font-family:Calibri; font-size:12pt">nCode</span><span style="font-family:Calibri; font-size:12pt">;</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">    UINT </span><span style="font-family:Calibri; font-size:12pt">nID</span><span style="font-family:Calibri; font-size:12pt">;</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">    UINT </span><span style="font-family:Calibri; font-size:12pt">nLastID</span><span style="font-family:Calibri; font-size:12pt">;</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">    UINT </span><span style="font-family:Calibri; font-size:12pt">nSig</span><span style="font-family:Calibri; font-size:12pt">;</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">    AFX_PMSG </span><span style="font-family:Calibri; font-size:12pt">pfn</span><span style="font-family:Calibri; font-size:12pt">;      //</span><span style="font-family:宋体; font-size:12pt">消息响应函数的指针</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">}</span></p><p style="margin:0pt; orphans:0; text-align:center; text-indent:24pt; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.007.jpeg" width="311" height="322" alt="" /></p><p style="line-height:20pt; margin:0pt; orphans:0; text-align:center; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">图</span><span style="font-family:'Times New Roman'; font-size:12pt">2-3 </span><span style="font-family:宋体; font-size:12pt">类的消息映射表</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在需要消息响应的类里面，会在里面声明一个</span><span style="font-family:Calibri; font-size:12pt">AFX_MSGMAP_ENTRY</span><span style="font-family:宋体; font-size:12pt">类型的数组</span><span style="font-family:Calibri; font-size:12pt">_</span><span style="font-family:Calibri; font-size:12pt">messageEntries</span><span style="font-family:Calibri; font-size:12pt">[]</span><span style="font-family:宋体; font-size:12pt">，这个数组就作为这个类的消息映射表。图</span><span style="font-family:Calibri; font-size:12pt">2-3</span><span style="font-family:宋体; font-size:12pt">展示了一个类的消息映射表。</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:Calibri; font-size:12pt">MFC</span><span style="font-family:宋体; font-size:12pt">使用宏的形式来声明和实现消息映射表。</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在类的声明中用</span><span style="font-family:Calibri; font-size:12pt">DECLARE_MESSAGE_MAP</span><span style="font-family:宋体; font-size:12pt">宏来声明消息映射表。</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在类的声明外，使用</span><span style="font-family:Calibri; font-size:12pt">BEGIN_MESSAGE_MAP</span><span style="font-family:宋体; font-size:12pt">和</span><span style="font-family:Calibri; font-size:12pt">END_MESSAGE_MAP</span><span style="font-family:宋体; font-size:12pt">一对宏来定义消息映射表的节点，并且往节点中插入数据。我们经常会看到在这两个宏之间有一些</span><span style="font-family:Calibri; font-size:12pt">ON_XXX</span><span style="font-family:宋体; font-size:12pt">宏的定义，这些宏就是向消息映射表中插入表项。</span><span style="font-family:Calibri; font-size:12pt">END_MESSAGE_MAP</span><span style="font-family:宋体; font-size:12pt">宏表示消息映射表的结束。</span></p><p style="margin:0pt; orphans:0; text-align:center; text-indent:24pt; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.008.jpeg" width="352" height="280" alt="" /></p><p style="line-height:20pt; margin:0pt; orphans:0; text-align:center; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">图</span><span style="font-family:'Times New Roman'; font-size:12pt">2-4</span><span style="font-family:宋体; font-size:12pt">类族的消息映射表</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在基于</span><span style="font-family:Calibri; font-size:12pt">MFC</span><span style="font-family:宋体; font-size:12pt">的应用程序中，所有需要响应消息的类都派生于</span><span style="font-family:Calibri; font-size:12pt">CCmdTarget</span><span style="font-family:宋体; font-size:12pt">类，所有这些类就形成了一个类族。所有类的消息映射表会在</span><span style="font-family:Calibri; font-size:12pt">CCmdTarget</span><span style="font-family:宋体; font-size:12pt">类中形成一个总的消息映射表。为了使类族的所有子类能够将自己的消息映射表添加到总的消息映射表，</span><span style="font-family:Calibri; font-size:12pt">MFC</span><span style="font-family:宋体; font-size:12pt">要求这个</span><span style="font-family:Calibri; font-size:12pt">CCmdTarget</span><span style="font-family:宋体; font-size:12pt">类族的每一个类都包含一个链表的节点，这个节点由</span><span style="font-family:Calibri; font-size:12pt">lpEntriesp</span><span style="font-family:宋体; font-size:12pt">和</span><span style="font-family:Calibri; font-size:12pt">pBaseMap</span><span style="font-family:宋体; font-size:12pt">两个指针组成。前一个指针指向本类的消息映射表，后一个指针指向基类的节点，由此就形成了一个单项链表，该链表包含该类族所有类的消息映射表。如图</span><span style="font-family:Calibri; font-size:12pt">2-4</span><span style="font-family:宋体; font-size:12pt">展示了一个类族的消息映射表。</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">由于这个总的消息映射表包含当前应用程序中的消息和消息响应函数之间的一个对应关系，因此这个总的消息映射表就是应用程序的消息映射表。有了这个消息映射表以后，</span><span style="font-family:Calibri; font-size:12pt">CCmdTarget</span><span style="font-family:宋体; font-size:12pt">类族中任何一个类对象接收的消息，都可以在这个消息映射表中找到与之对应的消息处理函数。</span></p><h2 style="font-size:16pt; line-height:173.33%; margin:13pt 0pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; widows:0"><a name="_Toc326858187"></a><a name="_Toc25336"></a><span style="font-family:Cambria; font-size:16pt; font-weight:bold">MFC</span><span style="font-family:宋体; font-size:16pt; font-weight:bold">文档</span><span style="font-family:Cambria; font-size:16pt; font-weight:bold">/</span><span style="font-family:宋体; font-size:16pt; font-weight:bold">视图框架中各个对象的关系</span></h2><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">在基于</span><span style="font-family:Calibri; font-size:12pt">MFC</span><span style="font-family:宋体; font-size:12pt">的应用程序开发中，绝大多数</span><span style="font-family:Calibri; font-size:12pt">Windows</span><span style="font-family:宋体; font-size:12pt">应用程序都是使用的文档</span><span style="font-family:Calibri; font-size:12pt">/</span><span style="font-family:宋体; font-size:12pt">视图框架结构。这种框架结构就是将传统的应用程序主窗口对象拆分成三个部分，这三部分分别是框架窗口类</span><span style="font-family:Calibri; font-size:12pt">CFrameWnd</span><span style="font-family:宋体; font-size:12pt">对象、视图类</span><span style="font-family:Calibri; font-size:12pt">CView</span><span style="font-family:宋体; font-size:12pt">对象和文档类</span><span style="font-family:Calibri; font-size:12pt">CDocument</span><span style="font-family:宋体; font-size:12pt">对象。这种拆分方式不仅大大减轻了窗口对象的负担和使得各个模块的分工更加的明确以及各个对象的任务更加的专一，而且大大方便了代码的编写和维护工作。其中，窗口框架类</span><span style="font-family:Calibri; font-size:12pt">CFrameWnd</span><span style="font-family:宋体; font-size:12pt">负责管理窗口框的大小、标题和菜单栏以及状态栏等部分；文档类</span><span style="font-family:Calibri; font-size:12pt">CDocument</span><span style="font-family:宋体; font-size:12pt">负责数据的存储和管理；视图类</span><span style="font-family:Calibri; font-size:12pt">Cview</span><span style="font-family:宋体; font-size:12pt">负责数据的显示和用户的交互。</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:21pt; widows:0"><span style="font-family:宋体; font-size:12pt">为了使程序框架的各个对象之间能够取得联系，文档、视图和窗口框架对象都从其基类继承了获取其他对象指针的方法。这样就可以在一个对象里的到其他对象的指针。比如，视图对象可以使用</span><span style="font-family:Calibri; font-size:12pt">GetDocument</span><span style="font-family:Calibri; font-size:12pt">()</span><span style="font-family:宋体; font-size:12pt">方法获得与其关联的文档对象指针；使用</span><span style="font-family:Calibri; font-size:12pt">GetParentFrame</span><span style="font-family:Calibri; font-size:12pt">()</span><span style="font-family:宋体; font-size:12pt">获得所属的框架窗口对象。</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">如果想要在框架窗口对象里面获取活动视图对象的指针可以使用</span><span style="font-family:Calibri; font-size:12pt">GetActiveView</span><span style="font-family:Calibri; font-size:12pt">()</span><span style="font-family:宋体; font-size:12pt">函数；要想获得视图对象的文档可以使用</span><span style="font-family:Calibri; font-size:12pt">GetActiveDocument</span><span style="font-family:Calibri; font-size:12pt">()</span><span style="font-family:宋体; font-size:12pt">函数。</span></p><p style="margin:0pt; orphans:0; text-align:justify; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">如果想要在文档对象里获取视图链表的视图对象，就需要使用</span><span style="font-family:Calibri; font-size:12pt">GetFirstViewPosition</span><span style="font-family:Calibri; font-size:12pt">()</span><span style="font-family:宋体; font-size:12pt">函数和</span><span style="font-family:Calibri; font-size:12pt">GetNextView</span><span style="font-family:Calibri; font-size:12pt">()</span><span style="font-family:宋体; font-size:12pt">函数。图</span><span style="font-family:Calibri; font-size:12pt">2-5</span><span style="font-family:宋体; font-size:12pt">展示了各个对象之间的联系。</span></p><p style="margin:0pt; orphans:0; text-align:center; text-indent:24pt; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.009.jpeg" width="418" height="331" alt="" /></p><p style="line-height:20pt; margin:0pt; orphans:0; text-align:center; text-indent:24pt; widows:0"><span style="font-family:宋体; font-size:12pt">图</span><span style="font-family:'Times New Roman'; font-size:12pt">2-5</span><span style="font-family:宋体; font-size:12pt">应用程序框架各对象之间的联系方法</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:12pt">&#xa0;</span></p><h2 style="font-size:16pt; line-height:173.33%; margin:13pt 0pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; widows:0"><a name="_Toc24484"></a><span style="font-family:宋体; font-size:16pt; font-weight:bold">建立窗口程序示例</span></h2><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:宋体; font-size:10.5pt; font-weight:bold">实验任务</span><span style="color:#ff0000; font-family:Calibri; font-size:10.5pt; font-weight:bold">2</span><span style="color:#ff0000; font-family:Calibri; font-size:10.5pt; font-weight:bold"> </span><span style="color:#ff0000; font-family:宋体; font-size:10.5pt; font-weight:bold">可视化</span><span style="color:#ff0000; font-family:宋体; font-size:10.5pt; font-weight:bold">程序开发</span><span style="color:#ff0000; font-family:宋体; font-size:10.5pt; font-weight:bold">：</span><span style="color:#ff0000; font-family:宋体; font-size:10.5pt">按照下述过程完整创建一个可视化程序</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:12pt">&#xa0;</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">关键机制：</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">控件</span><span style="font-family:Calibri; font-size:12pt">-&gt;</span><span style="font-family:宋体; font-size:12pt">添加成员变量</span><span style="font-family:Calibri; font-size:12pt">-&gt;</span><span style="font-family:宋体; font-size:12pt">添加事件函数</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">获取窗体句柄</span><span style="font-family:Calibri; font-size:12pt">-&gt;</span><span style="font-family:宋体; font-size:12pt">根据控件</span><span style="font-family:Calibri; font-size:12pt">ID</span><span style="font-family:宋体; font-size:12pt">获取控件句柄</span><span style="font-family:Calibri; font-size:12pt">-&gt;</span><span style="font-family:宋体; font-size:12pt">获取成员变量</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.010.png" width="554" height="380" alt="" /></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">创建</span><span style="font-family:Calibri; font-size:12pt">MFC</span><span style="font-family:宋体; font-size:12pt">应用程序</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.011.png" width="554" height="464" alt="" /></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">基于对话框的程序类型（非</span><span style="font-family:Calibri; font-size:12pt">unicode</span><span style="font-family:宋体; font-size:12pt">）</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.012.png" width="554" height="387" alt="" /></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">创建一个按钮，输入</span><span style="font-family:Calibri; font-size:12pt">“</span><span style="font-family:宋体; font-size:12pt">打开文件</span><span style="font-family:Calibri; font-size:12pt">”</span><span style="font-family:宋体; font-size:12pt">，并且重命名</span><span style="font-family:Calibri; font-size:12pt">ID</span><span style="font-family:宋体; font-size:12pt">为</span><span style="font-family:Calibri; font-size:12pt">IDC_BUTTON_OPEN</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">双击按钮，添加打开文件的函数：</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.013.png" width="554" height="207" alt="" /></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">注意，这里使用了</span><span style="font-family:Calibri; font-size:12pt">CFileDialog</span><span style="font-family:宋体; font-size:12pt">类。如果是要选择目录，则使用</span><span style="font-family:Calibri; font-size:12pt">API</span><span style="font-family:宋体; font-size:12pt">函数</span><span style="font-family:Calibri; font-size:12pt">SHBrowseForFolder</span><span style="font-family:宋体; font-size:12pt">以及</span><span style="font-family:Calibri; font-size:12pt">BROWSEINFO</span><span style="font-family:宋体; font-size:12pt">结构体的指针做参数变量。</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:12pt">&#xa0;</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">接下来，创建一个</span><span style="font-family:Calibri; font-size:12pt">EditBox</span><span style="font-family:宋体; font-size:12pt">，重命名为</span><span style="font-family:Calibri; font-size:12pt">IDC_EDIT_INFO</span><span style="font-family:宋体; font-size:12pt">，并且添加成员变量</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:12pt">&#xa0;</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.014.png" width="554" height="405" alt="" /></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.015.png" width="554" height="464" alt="" /></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">在源代码中查找</span><span style="font-family:Calibri; font-size:12pt">”</span><span style="font-family:Calibri; font-size:12pt">medit</span><span style="font-family:Calibri; font-size:12pt">”</span><span style="font-family:宋体; font-size:12pt">可以看出，成员变量与控件被关联起来：</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.016.png" width="554" height="45" alt="" /></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">在对话框中，追加文件打开信息：</span></p><p style="margin:0pt; orphans:0; text-align:center; widows:0"><span style="color:#010001; font-family:新宋体; font-size:9.5pt">mEditInfo</span><span style="font-family:新宋体; font-size:9.5pt">.</span><span style="color:#010001; font-family:新宋体; font-size:9.5pt">SetWindowTextA</span><span style="font-family:新宋体; font-size:9.5pt">(</span><span style="color:#010001; font-family:新宋体; font-size:9.5pt">strFilePath</span><span style="font-family:新宋体; font-size:9.5pt"> + </span><span style="color:#a31515; font-family:新宋体; font-size:9.5pt">"\n"</span><span style="font-family:新宋体; font-size:9.5pt">);</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:12pt">&#xa0;</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">最后，在对话框上绘制该图像的缩略图：</span></p><p style="margin:0pt 0pt 0pt 21pt; orphans:0; text-align:justify; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.017.png" width="554" height="92" alt="" /></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.018.png" width="554" height="369" alt="" /></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:12pt">&#xa0;</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">这是直接绘制。实际上对</span><span style="font-family:Calibri; font-size:12pt">PDC</span><span style="font-family:宋体; font-size:12pt">的操作，更多使用双缓存技术：</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><img src="\upfiles\html\\测试会议\测试议程2\test哈哈_docx\test哈哈_docx.019.png" width="554" height="256" alt="" /></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="font-family:Calibri; font-size:12pt">&#xa0;</span></p><h1 style="font-size:22pt; line-height:240.83%; margin:17pt 0pt 16.5pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; widows:0"><a name="_Toc325"></a><span style="font-family:宋体; font-size:22pt; font-weight:bold">三</span><span style="font-family:宋体; font-size:22pt; font-weight:bold"> </span><span style="font-family:宋体; font-size:22pt; font-weight:bold">多线程图像处理程序设计</span></h1><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:宋体; font-size:12pt; font-weight:bold">实验任务</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt; font-weight:bold">3 </span><span style="color:#ff0000; font-family:宋体; font-size:12pt; font-weight:bold">多线程图像处理基础：</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">已有程序例子，采用</span><span style="font-family:Calibri; font-size:12pt">MFC</span><span style="font-family:宋体; font-size:12pt">多线程开发方式实现如下功能</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">对一张大图像，使用</span><span style="font-family:Calibri; font-size:12pt">8</span><span style="font-family:宋体; font-size:12pt">个线程分区块同时进行自适应中值滤波，采用合适的界面展示滤波结果，并输出单线程与多线程处理的时间。</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">使用</span><span style="font-family:Calibri; font-size:12pt">8</span><span style="font-family:宋体; font-size:12pt">个线程对图像添加椒盐噪声，添加完成以后，再对其分</span><span style="font-family:Calibri; font-size:12pt">8</span><span style="font-family:宋体; font-size:12pt">个线程进行自适应中值滤波。</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:Calibri; font-size:12pt">&#xa0;</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:宋体; font-size:12pt">阅读程序框架，继续采用</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">Windows</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">多线程和</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">OpenMP</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">两种方式，补充实现下述功能：</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:宋体; font-size:12pt">采用三阶插值的图像任意角度旋转与缩放（参考材料</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">3.2.1</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">）</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:宋体; font-size:12pt">自动色阶与自动白平衡（参考材料</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">3.3.2</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">）</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:宋体; font-size:12pt">图像素描转换（参考材料</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">3.4.4</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">）</span></p><p style="margin:0pt"><span style="font-family:宋体; font-size:12pt">参考材料</span><span style="font-family:宋体; font-size:12pt">链接:http://pan.baidu.com/s/1mgMaaxU 密码:2rpa</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:Calibri; font-size:12pt">&#xa0;</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:Calibri; font-size:12pt">&#xa0;</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:宋体; font-size:12pt; font-weight:bold">实验任务</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt; font-weight:bold">4</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt; font-weight:bold"> </span><span style="color:#ff0000; font-family:宋体; font-size:12pt; font-weight:bold">图像</span><span style="color:#ff0000; font-family:宋体; font-size:12pt; font-weight:bold">融合与双边滤波</span><span style="color:#ff0000; font-family:宋体; font-size:12pt; font-weight:bold">：</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:Calibri; font-size:12pt">1</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">. </span><span style="color:#ff0000; font-family:宋体; font-size:12pt">采用</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">opencv</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">与</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">boost</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">库多线程开发方式，实现一个图像融合的程序，功能要求描述如下：</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:宋体; font-size:12pt">   </span><span style="color:#ff0000; font-family:宋体; font-size:12pt">图像</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">1</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">与图像</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">2</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">等大小，像素分别为</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">P1</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">，</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">P2</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">。采用</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">alpha</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">参数，每个点的像素值，等于</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">alpah</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">*P1 + </span><span style="color:#ff0000; font-family:宋体; font-size:12pt">（</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">1-alpha</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">）</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">*P2</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">，界面上显示滑动条拖动</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">alpha</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">从</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">0</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">到</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">1</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">时，图像融合的效果。</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:Calibri; font-size:12pt">2</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">. </span><span style="color:#ff0000; font-family:宋体; font-size:12pt">基于</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">opencv</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">的自适应双边滤波器函数，实现对图像的保边缘滤波。参考该算法，改造成基于</span><span style="color:#ff0000; font-family:Calibri; font-size:12pt">boost</span><span style="color:#ff0000; font-family:宋体; font-size:12pt">库多线程的实现方式。</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:Calibri; font-size:12pt">&#xa0;</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="color:#ff0000; font-family:Calibri; font-size:12pt">&#xa0;</span></p><h1 style="font-size:22pt; line-height:240.83%; margin:17pt 0pt 16.5pt; orphans:0; page-break-after:avoid; page-break-inside:avoid; text-align:justify; widows:0"><span style="font-family:宋体; font-size:22pt; font-weight:bold">四</span><span style="font-family:宋体; font-size:22pt; font-weight:bold"> </span><span style="font-family:宋体; font-size:22pt; font-weight:bold">实验结果提交</span><a name="_GoBack"></a></h1><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">任务</span><span style="font-family:Calibri; font-size:12pt">3</span><span style="font-family:宋体; font-size:12pt">、</span><span style="font-family:Calibri; font-size:12pt">4</span><span style="font-family:宋体; font-size:12pt">的源代码、可执行程序，以及</span><span style="font-family:Calibri; font-size:12pt">word</span><span style="font-family:宋体; font-size:12pt">文档实验报告：</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">实验报告描述实验任务</span><span style="font-family:Calibri; font-size:12pt">3</span><span style="font-family:宋体; font-size:12pt">和</span><span style="font-family:Calibri; font-size:12pt">4</span><span style="font-family:宋体; font-size:12pt">的实现算法，对应部分的代码解释。</span></p><p style="margin:0pt; orphans:0; text-align:justify; widows:0"><span style="font-family:宋体; font-size:12pt">提交时间：</span><span style="font-family:Calibri; font-size:12pt">2016-10-12</span></p></div></body></html>